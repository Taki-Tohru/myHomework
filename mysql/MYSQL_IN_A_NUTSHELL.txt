3.7分析和理
SELECT COUNT(*)
FROM books
JOIN authors USING (author_id)
WHERE author_last='Tolstoy';

=================
SELECT COUNT(*)
FROM emp
JOIN dept USING (DEPTNO)
WHERE DNAME='SALES';

-----------

SELECT SUM(sale_amount) AS 'Armadillo Sales'
FROM orders
JOIN books USING (book_id)
JOIN authors USING (author_id)
WHERE title = 'Armadillo'
AND author_last = 'Boyd';

==================

SELECT SUM(SAL) AS 'Research Sallary'
FROM emp
JOIN dept USING (DEPTNO)
WHERE DNAME = 'RESEARCH';

--------------
SELECT purchase_date AS 'Purchase Date'
FROM orders
WHERE sale_id = '1250';

=====================

SELECT HIREDATE AS 'Hire Date'
FROM emp
WHERE EMPNO = 7698;

-----------

SELECT CONCAT(MONTHNAME(purchase_date), ' ' ,
DAYOFMONTH(purchase_date), ', ',
YEAR(purchase_date)) AS 'Purchase Date'
FROM orders
WHERE sale_id = '1250';

======================

SELECT CONCAT(MONTHNAME(HIREDATE), ' ' ,
DAYOFMONTH(HIREDATE), ', ',
YEAR(HIREDATE)) AS 'Hire Date'
FROM emp
WHERE EMPNO = 7698;

------------

SELECT DATE_FORMAT(purchase_date, "%M %d, %Y")
AS 'Purchase Date'
FROM orders
WHERE sale_id = '1250';

====================

SELECT DATE_FORMAT(HIREDATE, "%M %d, %Y")
AS 'Hire Date'
FROM emp
WHERE EMPNO = 7698;


3.8 修改

UPDATE books
SET pub_year = '1938'
WHERE book_id = '2';
-----
ALTER TABLE books
CHANGE COLUMN isbn VARCHAR(20) UNIQUE;
----
REPLACE INTO books
(title, author_id, isbn, genre, pub_year)
VALUES('Brighton Rock', 1, '0099478471', 'novel', '1938'),
('The Quiet American', 1, '0099478393', 'novel', '1955');

3.9 h除
DELETE FROM books
WHERE author_id =
    (SELECT authors.author_id FROM authors
     WHERE author_last = 'Rowling'
     AND author_first = 'J.K.');
----------
DELETE FROM authors
WHERE authors_last = 'Rowling'
AND author_first = 'J.K.';
-----
SET @potter = 
    (SELECT author_id FROM authors
     WHERE author_last = 'Rowling'
     AND author_first = 'J.K.');

DELETE FROM books
WHERE author_id = @potter;

DELETE FROM authors
WHERE author_id = @potter;
=========
SET @EMPNO =
    (SELECT EMPNO FROM emp
     WHERE JOB = 'CLERK'
     AND ENAME = 'SMITH');

SELECT * FROM emp
WHERE EMPNO = @EMPNO;
---------------
3.10 查
SELECT book_id, title,
CONCAT(author_first, ' ', author_last) AS author
FROM books
JOIN authors USING (author_id)
WHERE title LIKE '%traveler%'
AND title LIKE '%winter%'
==========
SELECT EMPNO,
CONCAT(ENAME, ' is ', JOB) AS EMPLOYEE_STATUS
FROM emp
JOIN dept USING (DEPTNO)
WHERE DNAME LIKE '%ACC%'; 

---------
SELECT book_id, title
FROM books
WHERE author_id = 1
AND title LIKE '%Stamboul%'
OR author_id = 1
AND title LIKE '%Orient%';
值得注意的是，在每表_式中都要指定author_id的值，否t我可能得到其他作者的
作品名中包含查字符的D信息。
============
SELECT EMPNO, ENAME
FROM emp
WHERE MGR = 7698
AND ENAME LIKE '%A%'
OR MGR = 7698
AND ENAME LIKE '%W%';

3.11  批量入
在D熘校假O一u主lo我一磁P，磁P鹊囊文本文件列出了他所有的
D信息。每本的是为的一行，Q把每的字段分_。下面是一的u主
文本文件：
ISBN|TITLE|AUTHOR LAST|AUTHOR FIRST|COPYRIGHT DATE|
067973452X|Notes from Underground|Dostoevsky|Fyodor|August 1994|
...
第一行是中字段的描述。不需要提取第一行，於我而言，它只是ψ侄蔚恼f明。因此，入SQLZ句r可MySQL⑵浜雎浴

就而言，我必P注以下}。首先，字段K]有按表中的序排列。我必
MySQL知道⒁入的的序，以便做{整。另一}是，文本文件中既包含books表的
，也有authors表的。@}比^麻，但是可以解Q的。我H用一lSQLZ句就
可以提取作者的信息，然後再\行一为的SQLZ句入D信息。在_始操作前，我先
名books.txt的u主文件}u到Rr目（例如：/tmp）。先在，可以mysql客C\行
LOAD DATA INFILEZ句了：

LOAD DATA INFILE '/tmp/books.txt' REPLACE INTO TABLE authors
FIELDS TERMINATED BY '|' LINES TERMINATED BY '\r\n'
TEXT_FIELDS(col1, col2, col3, col4, col5)
SET author_last = col3, author_first = col4
IGNORE col1, col2, col5, 1 LINES;

=========
GRADE|LOSAL|HISAL|
6|10000|12000|
7|12001|14000|
8|14001|17000|

LOAD DATA INFILE 'D:/mysql_test/salgrade.txt' REPLACE INTO TABLE salgrade
FIELDS TERMINATED BY '|'
LINES TERMINATED BY '\r\n'
IGNORE 1 LINES
  (GRADE, LOSAL, HISAL);

首先需要指出，管本已多次出FIGNORE n LINES子句，但MySQL 4.1及之前的版本K不支持
c列相P的TXT_FIELDS和IGNORE子句。使用IGNORE 1 LINES，文本文件中包含列祟}的第一行信息
⒈缓雎浴；氐SQLZ句的第一行，我已指定了⒁入的文件名以及⒈谎bd的表名。
REPLACE擞c前面提到的REPLACEZ句的作用相同。然，姓名字段]有O置成唯一值，就MySQL
而言⒉出F任何重}的}。在H情r下，你是修改表以防止作者姓名有
重}。

在第二行中，我指定每字段以Q作Y束符，每行以回(\r)Q行(\n)Y束。@是
MS-DOS系y下的文本文件而言的。UNIX下H以Q行符作行的Y束。

在第三行SQLZ句中，我每字段建了一e名。在第四行Z句中，基於前一行Z句o出的
e名，我o表中⒁接收的列O置e名。

最後一行Z句中，我通知MySQL忽略不想要的列，以及第一行信息，因@些被略去的热莶话含
信息。

----
如果你使用的f版本MySQL不支持忽略列的操作，t需绦~外的步E。有追N不同的F
方式。如果⒈谎bd的表不是很大，t可以裼靡蔚姆椒ǎ就是authors表添加
三~外的Rr列，@些列用於接收文本文件中想要略去的字段值以便以後⑵h除。F上述
操作的SQLZ句如下所示：
ALTER TABLE authors
ADD COLUMN col1 VARCHAR(50),
ADD COLUMN col2 VARCHAR(50),
ADD COLUMN col5 VARCHAR(50);

LOAD DATA INFILE '/tmp/books.txt' REPLACE INTO TABLE authors
FIELDS TERMINATED BY '|' LINES TERMINATED BY '\r\n'
IGNORE 1 LINES
(col1, col2, author_last, author_first, col5);

ALTER TABLE authors
DROP COLUMN col1,
DROP COLUMN col2,
DROP COLUMN col5;
上述第二SQLZ句中IGNORE子句指定了⒈缓雎缘男小ＴZ句的最後一行列出了authors表中
的所有列，@些列⒔邮，K且按照入的序排列。
第三SQLZ句Y束馁u主的文本文件中入的操作，F在我使用DROPZ句h除Rr列
以及列中的。DROPZ句绦嗅峋筒荒艹蜂N了，因此要慎用Z句。
------
如果我想奈谋疚募中⒆髡咝畔⒘醒}u到authors表中，t需要先bdbooks表中的，
得到每本正_的author_id值，通^下列Z句可F：
LOAD DATA INFILE '/tmp/books.txt' IGNORE INTO TABLE books
FIELDS TERMINATED BY '|' LINES TERMINATED BY '\r\n'
TEXT_FIELDS(col1, col2, col3, col4, col5)
SET isbn = col1, title = col2,
pub_year = RIGHT(col5, 4),
author_id = 
    (SELECT author_id
     WHERE author_last = col3
     AND author_first = col4)
IGNORE col3, col4, 1 LINES;

在@SQLZ句中，我添加了方法慝@取所需Y果。在第五行中，我使用字符串函RIGHT()
copyright字段中提取年份（copyright字段中包含年和月）。RIGHT()函堤崛×酥付ǖ牡诙
col5中的後四字符。




第4章 安全、用粽Z句和函

4.1 Z句和函
下面是本章涉及的c安全和用粲嘘P的Z句列表：
CREATE USER, DROP USER, FLUSH, GRANT, RENAME USER, RESET, REVOKE, SET PASSWORD,
SHOW GRANTS, SHOW PRIVILEGES.
下面是本章c函涤嘘P的Z句列表：
AES_DECRYPT(), AES_ENCRYPT(), CURRENT_USER(), DECODE(), DES_DECRYPT(),
DES_ENCRYPT(), ENCODE(), ENCRYPT(), MD5(), OLD_PASSWORD(), PASSWORD(),
SESSION_USER(), SHA(), SHA1(), SYSTEM_USER(), USER().

4.2 按字母排序的SQLZ句

---------
CREATE USERZ法

CREATE USER 'user'[@'host']
[IDENTIFIED BY [PASSWORD] 'password'] [,...]

如果]有指定password子句，默J情r下空密a。此r，存在着在的安全}，千f不要
@N做！如果你犯^@拥腻e`，使用SET PASSWORDZ句碓O置密a。

可以使用由逗分隔的列表指定多用簟

MySQL 5.0.2版本_始引入了CREATE USERZ句。在以前的版本中，使用GRANTZ句。@一新增Z句
cGRANTZ句的作用是似的，只是使用CREATE USER Z句o法指定用嘞蕖Ｒ虼耍^程是@拥模菏紫仁褂CREATE USERZ句建用簦然後使用GRANTZ句授予用嘞蕖＿@二步^程具有很大的性，尤其於MySQL的新手碇v。然而，你可以HH使用GRANTZ句建新用K其O置嘞蕖

要想使用CREATE USERZ句，你必碛邪含用粜畔⒑嘞薜mysql斓CREATE USER嘞藁蛘碛INSERT嘞蕖Ｒ想撤N用簟⒄使用DROP USERZ句，也可以使用REVOKEZ句。

CREATE USER 'paola'@'localhost'
IDENTIFIED BY 'her_password',
'paola'@'caporale.com'
IDENTIFIED BY 'her_password';
-------------
DROP USERZ法

DROP USER 'user'@'host'
使用DROP USERZ句可以h除MySQL服掌魃系挠簟MySQL 5.0.2版本_始，@lZ句h除
用艉碜运有授啾淼奶唷
使用Z句，必碛邪含了用粜畔⒑嘞薜mysql斓CREATE USER嘞藁蛘DELETE嘞蕖h除用K不影它的前。只有用艚Y束打_的ru起作用。已h除的用羧绻想K止一打_的客舳，可以使用KILLZ句（第7章）F。

一些用艨赡懿恢褂幸簦ㄈ缬艉椭C的M合）。了_保@一c，你z查服掌鞯
mysql.user表：
SELECT User,Host
FROM mysql.user
WHERE User LIKE 'paola';

DROP USER 'paola'@'localhost',
'paola'@'caporale.com';

在MySQL 5.0.2版本之前，DROP USERZ句K不能h除具有全局嘞薜挠簟了撤N用舻嘞蓿在使用DROP USERZ句之前，使用REVOKEZ句：
REVOKE ALL ON *.* FROM 'paola'@'localhost';

DROP USER 'paola'@'localhost';
ALLx用以_保撤N所有嘞蕖*.*涵w了所有熘械乃有表。在MySQL 4.1.1版本之前，你
必使用如下Z句不是DROP USERZ句：
DELETE FROM mysql.user
WHERE User = 'paola' AND Host = 'localhost';

FLUSH PRIVILEGES;
注意，必使用FLUSH PRIVILEGESZ句才能令前面的DELETEZ句立即生效。在DROP USERZ句之後，@Z句K非是必需的。

------------
FLUSHZ法

FLUSH [LOCAL|NO_WRITE_TO_BINLOG] option[, ...]
x：
    DES_KEY_FILE, HOSTS, LOGS, MASTER, PRIVILEGES, QUERY_CACHE,
    STATUS, TABLE, TABLES, TABLES WITHOUT READ LOCK, USER_RESOURCES

使用FLUSHZ句可以清除K重dMySQL的Rr存。要想绦FLUSH命令，你必碛RELOAD嘞蕖了防止Z句入二M制日I文件，你可以使用NO_WRITE_TO_BINLOG擞或者其e名LOCAL。

MySQL 5.1版本_始，FLUSH不能用在存函岛陀|l器之中，但是可以用在存^程中。作FLUSHZ句的替代者，你可以使用mysqladmin命令（⒁16章）。
-------------
GRANTZ法

GRANT privilege[, ...] [(column[, ...])][, ...]
ON [TABLE|FUNCTION|PROCEDURE] {[{database|*}.{table|*}] | *}
TO 'user'@'host' [IDENTIFIED BY [PASSWORD] 'password'][, ...]

[REQUIRE NONE | 
[{SSL|X509}] [CIPHER 'cipher' [AND]]
[ISSUER 'issue' [AND]]
[SUBJECT 'subject']]

[WITH [GRANT OPTION | 
       MAX_QUERIES_PER_HOUR count | 
       MAX_UPDATES_PER_HOUR count | 
       MAX_CONNECTIONS_PER_HOUR count |
       MAX_USER_CONNECTIONS count] ...]

想t解於指定用舻氖啵可以使用在本章後面部分v述的SHOW GRANTSZ句。
我可以用羰谟柙S多不同的嘞蓿因此可以使用PI字ALL斫M合@些的嘞藜。下面示例：
GRANT ALL PRIVILEGES ON *.*
TO 'evagelia'@'localhost'
IDENTIFIED BY 'papadimitrou1234'
WITH GRANT OPTION;
在@示例中，我建了evagelia用簟Ｓ伸妒褂昧ALLPI字，所以我用羰谟枇怂有的
基本嘞蕖＿@K不包含用艨梢允褂GRANTZ句的能力，也就是f用舨痪GRANT嘞蕖了令用艟GRANT嘞蓿需要指定WITH GRANT OPTION子句，如上例所示，明_地用羰谟柙嘞蕖３非特e需要，本不建h你@N做。

GRANT SELECT ON workrequests.*
TO 'jerry'@'localhost' IDENTIFIED BY 'neumeyer3186';

GRANT SELECT,INSERT,UPDATE ON workrequests.workreq
TO 'jerry'@'localhost' IDENTIFIED BY 'neumeyer3186';

workrequests   workreq表

----------
GRANT：限制B接型

GRANT privilege[, ...] [ (column[, ...]) ][, ...]
ON [TABLE|FUNCTION|PROCEDURE] {[{database|*}.{table|*}] | *}
TO 'user'@'host' [IDENTIFIED BY [PASSWORD] 'password'][, ...]

[REQUIRE NONE |
[{SSL|X509} [AND]]
[CIPHER 'cipher' [AND]]
[ISSUER 'issue' [AND]]
[SUBJECT 'subject']]

[time and number of connection limits] ...]

REQUIRE SSLx限制用糁豢梢赃M行SSL加密B接。用舻mysql客Cв--ssl-cax的客C，如果需要的，也в--ssl-key和--ssl-certx：
GRANT ALL PRIVILEGES ON workrquests.* TO 'rusty'@'localhost'
IDENTIFIED BY 'her_password'
REQUIRE SSL;

使用REQUIRE X509x要求用碛幸有效的CAC明。管@K不需要用艟哂腥我獾奶厥庾C明。mysql客Cr，需要使用--ssl-ca,--ssl-key和--ssl-certx。了化理@些x，用艨梢园阉放在一服掌鞯陌惭b目中的x文件中（如~/.my.cnf）。下面的一示例展示了包含@些x的文件c用粝拗埔恢拢
[client]
ssl-ca=/data/mysql/cacert.pem
ssl-key=/data/mysql/rusty-key.pem
ssl-cert=/data/mysql/rusty-cert.pem

使用REQUIRE CIPHERx需要用糁付ㄒcipher方法：

GRANT ALL PRIVILEGES ON workrequests.* TO 'rusty'@'localhost'
IDENTIFIED BY 'her_password'
REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';

REQUIRE ISSUER通常用硪求用籼峁┯行У淖C明，它是由CAl训囊X.509C明。l颜呓o出的字符串或S有cL，它必是一非嵌入在Q行中的字符串：
GRANT ALL PRIVILEGES ON workrequests.* TO 'rusty'@'localhost'
IDENTIFIED BY 'her_password'
REQUIRE ISSUER '/C=US/ST=Louisiana/L=NEW+20Orleans/O=WorkRequesters/CN=
   cacert.workrequests.com/emailAddress=admin@workrequests.com';

REQUIRE SUBJECTx需要具有o定主}的用羰褂眠^X.509C明：
GRANT ALL PRIVILEGES ON workrequests.* TO 'rusty'@'localhost'
IDENTIFIED BY 'her_password'
REQUIRE ISSUER '/C=US/ST=Louisiana/L=NEW+20Orleans/O=WorkRequesters/CN=
   Rusty Osborne/emailAddress=rusty@workrequests.com';
-------------
GRANT: B接次岛的康南拗

GRANT privilege[, ...] [(column[, ...])][, ...]
ON [TABLE|FUNCTION|PROCEDURE] {[{database|*}.{table|*}] | *}
TO 'user'@'host' [IDENTIFIED BY [PASSWORD] 'password' ][, ...]

[type of connection restrictions]

[WITH [MAX_QUERIES_PER_HOUR count |
       MAX_UPDATES_PER_HOUR count |
       MAX_CONNECTIONS_PER_HOUR count |
       MAX_USER_CONNECTIONS count] ...]

你可以使用вMAX_QUERIES_PER_HOURx的WITH子句用糁付每小r绦胁樵的最大盗俊
MAX_UPDATES_PER_HOURx可以指明在UPDATEZ句中用裘啃rl出的最大更新的俊
MAX_CONNECTIONS_PER_HOURx用以指明用裘啃r可以同rB接服掌鞯淖畲盗俊

@3x的默J值是0。此值表示@些Y源]有（任何）限制。MAX_USER_CONNECTIONSx用碓O置o定的用艨梢酝rB接的最大的俊Ｈ绻]有O置@值或者其值0，t使用系y量max_user_connections的值（_定艨梢酝rB接的盗浚。下面是一如何使用@N方式磉M行限制的示例：
GRANT SELECT ON catalogs.*
TO 'webuser'@'%'
WITH MAX_QUERIES_PER_HOUR 1000
MAX_CONNECTIONS_PER_HOUR 100;
上述示例O成用簦webuser）通^Web服掌鬟M行查的用的俊＿@lZ句建webuser用K允S他catalogs熘凶x取表。在1小r扔舨樵的次挡荒艹^1000，在1小rHH可以建立100次B接。

在不改衄F有嘞薜那r下，要想改F有用ぬ的Y源，你可以使用PI字USAGE。你可以蔚剌入似下面的Z句：
GRANT USAGE ON catalogs.*
TO 'webuser'@'%'
WITH MAX_QUERIES_PER_HOUR 10000
MAX_CONNECTIONS_PER_HOUR 100;

有P嘞薜牧斜(PAGE 53)
GRANT和REVOKE嘞

嘞
ALL [PRIVILEGES]
ALTER
ALTER ROUTINE
CREATE
CREATE ROUTINE
CREATE TEMPORARY TABLES
CREATE USER
CREATE VIEW
DELETE
DROP
EVENT
EXECUTE
FILE
GRANT OPTION
INDEX
INSERT
LOCK TABLES
PROCESS
REFERENCES
RELOAD
REPLICATION CLIENT
REPLICATION SLAVE
SELECT
SHOW DATABASES
SHOW VIEW
SHUTDOWN
SUPER
TRIGGER
UPDATE
USAGE

--------------
RENAME USERZ法

RENAME USER 'user'[@'host'] TO 'user'[@'host'][, ...]
使用Z句改用裘或者原有用舻闹C。它K不能修改用嘞藁蛘甙讶魏嘞捱w移到臁⑹录、存Τ绦颉⒈怼⒂|l器或者D上。如下面示例所示：
RENAME USER 'michaelzabalaoui'@'localhost' TO 'zabb'@'%',
'richardstringer'@'localhost' TO 'littlerichard'@'localhost';
在此修改淼谝用舻拿字和主C，第二用HH修改了他的名字。
-------
RESETZ法

RESET [QUERY CACHE|MASTER|SLAVE]
使用RESETZ句碇刂媚承┓掌鞯沫h境和日I文件。需指定RELOAD嘞r才可以使用@lZ句。QUERY CACHEx清空包含SQL查Y果的存。

MASTERx重置用於}u的主服掌鳌
SLAVEx用於重置}ur的俜掌鳌

---------
REVOKEZ法

REVOKE ALL PRIVILEGES, GRANT OPTION FROM user[, ...]

REVOKE privilege[, ...] [(column[, ...])]
ON {[{database|*}.{table|*}] | *}
FROM 'user'@'host'[, ...]
使用@lZ句撤N用GRANTZ句授予o用舻牟糠只蛘咚有嘞蕖５谝lZ句用沓蜂N用舻乃有嘞蕖？梢允褂枚禾分隔符碇贫ǘ嘤袅斜怼Ｓ袅斜砑捌嘞薮υmysql熘校尤其是在user表中：

REVOKE ALL PRIVILEGES
ON *.*
FROM 'paola'@'localhost';

若要撤N指定列的嘞蓿在A括中用逗分隔符列e出的列。基於列的嘞薮υmysql斓columns_priv表中。
---------
SET PASSWORDZ法

SET PASSWORD [FOR 'user'@'host'] = PASSWORD('password')

了得到你的服掌魃嫌舻囊列表，入下列SQLZ句：
SELECT User,Host FROM mysql.user;

在SET PASSWORDZ句中如果]有指定FOR字句，默J情r下前用簟：PASSWORD()o定的密aM行加密。

在@lZ句的後面不必o跟FLUSH PRIVILEGESZ句。他新密a自痈新嘞薜木存。如果你的服掌MySQL 4.1之前的版本更新到一新的版本，在修改用舻拿艽ar可能遇到}，@回е掠舻拿艽ao效。你需要\行mysql_fix_privilege_tables用工具硇薷脑mysql熘械user表中的Password列。（P於用工具⒁16章）

下面是一修改用裘艽a的一示例：
SET PASSWORD FOR 'kenneth'@'localhost' = PASSWORD('his_password');

---------
SHOR GRANTZ法

SHOW GRANTS [FOR 'user'[@'host']]
@lSQLZ句o定的用袅谐隽GRANTZ句。如果]有指定FOR字句，默J前用簟Ｈ绻o定的用裘]有⒖继囟ǖ闹C，默J使用通配符%。否t，用裘後面需跟着主C，如下所示：

SHOW GRANTS FOR 'russell'@'localhost'\G

-----------
SHOW PRIVILEGESZ法

SHOW PRIVILEGES

@lZ句@示可用的系y嘞耷危後面跟着每一的上下文（如服掌鞴芾恚┖兔枋觥］出K不是依用矶ǖ摹H上，它是一完整的分配o用舻嘞蘖斜怼MySQL 4.1版本_始@lZ句u
是可以用的。
------

++++++++++++++++++++++
第5章  旌捅砟Ｊ秸Z句

本章涵w了如下Z句：
ALTER DATABASE, ALTER SCHEMA, ALTER SERVER, ALTER TABLE, ALTER VIEW, 
CREATE DATABASE, CREATE INDEX, CREATE SCHEMA, CREATE SERVER, CREATE TABLE, CREATE VIEW,
DESCRIBE, 
DROP DATABASE, DROP INDEX, DROP SERVER, DROP TABLE, DROP VIEW, 
RENAME DATABASE, RENAME TABLE, 
SHOW CHARACTER SET, SHOW COLLATION, SHOW COLUMNS, 
SHOW CREATE DATABASE, SHOW CREATE TABLE, SHOW CREATE VIEW, 
SHOW DATABASES, SHOW INDEXES, SHOW SCHEMAS, SHOW TABLES STATUS, SHOW TABLES, SHOW VIEWS.


以字母排序的Z句和子句
----------
ALTER {DATABASE|SCHEMA} database
[DEFAULT] CHARACTER SET character_set |
[DEFAULT] COLLATE collation

使用@lZ句硇薷斓脑O置。MySQL4.1.1版本_始引入了函K添加了一名db.opt的文件，文件包含了炷夸中的飙h境。前，可以使用如下二x：
CHARACTER SET和COLLATE。下面是一典型的db.opt文件的热荩
default-character-set=latin1
default-collation=latin_swedish_ci

m然管理T可以手工修改@文件，但是使用ALTER DATABASEZ句硇薷倪@文件更妥一些。MySQL5.0.2版本_始，ALTER SCHEMAcALTER DATABASE是同x~。要想使用@lZ句必具有ALTER嘞蕖

CHARACTER SETx可用碓O置@示的第一行，指定用到的斓哪J字符集。COLLATEx用碓O置第二行，指定默J的斓恼序（字符底秩绾伟醋帜疙序排序）。下面是使用@lZ句的示例：
ALTER DATABASE human_resources
CHARACTER SET latin2_bin
COLLATE latin2_bin;

注意@二x可以在一SQLZ句中指定。DEFAULTPI字K不是必的，但是它提供了c其他煜到y的兼容性。MySQL 4.1.8版本_始，如果在SQLZ句中省略了斓拿字，t默J使用前的臁４_定前欤使用DATABASE()函担
SELECT DATABASE();

P於字符集和字符校Φ母多信息，⒁本章後面P於SHOW CHARACTER SET和SHOW COLLATION的f明。
---------
ALTER SCHEMA

ALTER {DATABASE|SCHEMA} database
[DEFAULT] CHARACTER SET character_set |
[DEFAULT] COLLATE collation

@lZ句cALTER DATABASE是同x~。
-------
ALTER SERVER

ALTER SERVER server
OPTIONS (
    {HOST host, |
     DATABASE database, |
     USER user, |
     PASSWORD password, |
     SOCKET socket, |
     OWNER character, |
     PORT port }
)

使用@l支持FEDERATED存σ擎的SQLZ句硇薷挠CREATE SERVER建的服掌鞯倪B接怠Ｔmysql斓server表中存α嗽值。o定的颠x用逗分隔。x值必用字符串或抵滴淖郑UTF-8，最大L度64字符）。Z句MySQL 5.1.15版本_始引入，而且需要具有SUPER嘞薹娇墒褂谩
ALTER SERVER server1
OPTIONS (USER 'test_user', PASSWORD 'testing123', PORT 3307);
@示例修改了F有服掌鞯闹担用裘和B接服掌鞯亩丝凇
----------
ALTER TABLE

ALTER [IGNORE] TABLE table changes[, ...]

IGNORE擞m用於所有的子句，表示MySQL忽略有P列改rl生}u行的e`信息。它令你查找到唯一的行Kh除重}的行。否t，⒔K止Z句K撤N所有化。

要想修改表，Z句至少需要具有ALTER,CREATE和INSERT嘞蕖．绦ALTER TABLEZ句r，用裟茏x取表，但是通常情r下他不能在表中修改或添加。修改表r，使用в胁煌暾的DELAYED档INSERTZ句被取消，而且G失。增加系y量myisam_sort_buffer_size的容量，有r增加修改MyISAM表的速度。

---------
ALTER TABLE:m用於列的ADD子句

ALTER [IGNORE] TABLE table
ADD [COLUMN] column definition [FIRST|AFTER column]
ADD [COLUMN] (column definition, ...)

默J情r下，被添加的列追加到表的末尾。在ADD COLUMN子句後面使用FIRSTPI字，就能在表的_^添加一新列。在ADD COLUMN子句後面使用AFTERPI字，後面接列的名字，就能在一已存在的列後面增加一新列。

ALTER TABLE workreq
ADD COLUMN req_type CHAR(4) AFTER req_date,
ADD COLUMN priority CHAR(4) AFTER req_date;
注意，你可以在一ALTER TABLEZ句中指定更多的子句；@些子句使用逗矸指簟
---------
ALTER TABLE:m用於仕饕的ADD子句

ALTER [IGNORE] TABLE table
ADD {INDEX|KEY} [index] [USING index_type] (column,...)

使用ADD INDEX子句向一表中添加索引。如果你省略了索引的名字，MySQL用你建索引的列的名字作索引名。可以f明索引的型，但是通常情r下@K不是必需的。你必在A括中以逗作分隔符碇付ㄒ涣谢蚨嗔械乃饕名。

下面是P於如何使用ALTER TABLEZ句碓黾铀饕的示例，後面跟着SHOW INDEXESZ句用以@示Z句绦幸葬岬慕Y果：
ALTER TABLE clients
ADD INDEX client_index
(client_name(10), city(5)) USING BTREE;

SHOW INDEXES FROM clients \G

我添加的索引Qclient_index。它基於如下二列：client_name列的前10字符和city列的前5字符。在索引中限定字符涤兄於精索引，增加速度，它和使用完整的列度一泳_。即使有的索引包含了二行，SHOW INDEXESZ句绦薪Y果每一索引列@示了为的行。

@示例中的表使用了MyISAM存σ擎，引擎使用默J的BTREE索引型，因此不必指定索引型。

在MySQL5.1.10版本之前，在列列表之前或之後也可以使用USING子句，但是MySQL 5.1.10版本_始，必o跟列列表。
-------------
ALTER TABLE:m用於FULLTEXT索引的ADD子句

ALTER [IGNORE] TABLE table
ADD FULLTEXT [INDEX|KEY] [index] (column, ...) [WITH PARSER parser]

ADD FULLTEXT子句在已存在的MyISAM中TEXT列添加索引。FULLTEXT索引也可以CHAR和VARCHAR列添加索引。@N型的索引必使用FULLTEXT功能（⒁第11章的MATCH()... AGAINST() 函担。MySQL 5版本_始PI字INDEX和KEY是可x的。

使用索引，於o定的每一列，用到整列。m然它可以令它使用表中的前字符，於索引碇v，它依然使用全部的列。於FULLTEXT索引碇v，使用WITH PARSER子句指定Z法分析程序插件（parser plugin）：
ALTER TABLE workreq
ADD FULLTEXT INDEX notes_index
(client_description, technician_notes);

SHOW INDEXES FROM workreq\G

...

MySQL 5.1版本_始，你可以使用WITH PARSER子句FULLTEXT索引指定Z法分析程序插件。x需要加dmysql熘械牟寮表(plugin table)。表是前MySQL安b的一部分。如果你升了MySQL，插件表]有在你的系ymysql中，那N使用mysql_upgrade_本把插件表添加到mysql熘小Ｊ褂SHOW PLUGINSZ句聿榭匆呀安b了哪些插件。

page69
------------
ALTER TABLE:m用於SPATIAL索引的ADD子句

ALTER [IGNORE] TABLE table
ADD SPATIAL [INDEX|KEY] [index] (column, ...)

示例：
ALTER TABLE squares
ADD SPATIAL INDEX square_index (square_points);

SHOW INDEXES FROM squares \G
注意，在我建表r，我指定列square_points是NOT NULL。要想在列上建立索引，@是必需的。（⒁本章的m用於SPATIAL索引的CREATE INDEXZ句）

------------
ALTER TABLE:m用於外I的ADD子句

ALTER [IGNORE] TABLE table
ADD [CONSTRAINT [symbol]] PRIMARY KEY [USING index_type] (column, ...) |
ADD [CONSTRAINT [symbol]] UNIQUE [INDEX|KEY] index [USING index_type]
    (column, ...)
ADD [CONSTRAINT [symbol]] FOREIGN KEY [index] (column, ...)
    [REFERENCES table (column, ...)
    [ON DELETE {RESTRICT|CASCADE|SET NULL|NO ACTION|SET DEFAULT}]
    [ON UPDATE {RESTRICT|CASCADE|SET NULL|NO ACTION|SET DEFAULT}]]

@些ADD子句用於添加外IK⒄樟InnoDB表。外I是一索引，索引⒄樟肆硗庖表中的I或者索引。（⒁本章後面的CREATE TABLEf明）。

如下示例：
CREATE TABLE employees
(emp_id INT AUTO_INCREMENT PRIMARY KEY,
 tax_id CHAR(12),
 emp_name VARCHAR(100))ENGINE = INNODB;

CREATE TABLE employees_telephone
(emp_id INT,
 tel_type ENUM('office','home','mobile'),
 tel_number CHAR(25))ENGINE = INNODB;

ALTER TABLE employees_telephone
ADD FOREIGN KEY emp_tel (emp_id)
REFERENCES employees (emp_id)
ON DELETE RESTRICT;

因SHOW INDEXESZ句不能@示外Is束，所以我看一下使用SHOW TABLE STATUSZ句所a生的Y果：

SHOW TABLE STATUS FROM human_resources
LIKE 'employees_telephone' \G